

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Archive and Result File Examples &mdash; pyansys 0.39.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working with a ANSYS Full File (full)" href="loading_km.html" />
    <link rel="prev" title="Working with a ANSYS Result File (rst)" href="loading_results.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyansys
          

          
          </a>

          
            
            
              <div class="version">
                0.39.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">APDL Python Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ansys_control.html">ANSYS APDL Interactive Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="ansys_functions.html">ANSYS Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="apdl_conversion.html">APDL Conversion Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ansys_examples.html">ANSYS APDL Interactive Control Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">File IO and Visualization</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ansys_write_archive.html">Reading and Writing ANSYS Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_results.html">Working with a ANSYS Result File (rst)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Archive and Result File Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-and-plotting-an-ansys-archive-file">Loading and Plotting an ANSYS Archive File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-and-plotting-results-from-an-ansys-result-file">Loading and Plotting Results from an ANSYS Result File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-result-file">Loading the Result File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-nodal-results">Plotting Nodal Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#animating-a-modal-solution">Animating a Modal Solution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-examples">Built-In Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plot-cell-quality">Plot Cell Quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-nodal-stress">Plot Nodal Stress</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="loading_km.html">Working with a ANSYS Full File (full)</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_emat.html">Working with a ANSYS Element Matrix File (.emat)</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Result Visulization Gallery</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyansys</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Archive and Result File Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="archive-and-result-file-examples">
<h1>Archive and Result File Examples<a class="headerlink" href="#archive-and-result-file-examples" title="Permalink to this headline">¶</a></h1>
<p>These examples show how ANSYS binary and ASCII files can be read and displayed using pyansys.  These examples are meant to demonstrate the capabilities of pyansys.  For more details see the other reference pages.</p>
<div class="section" id="loading-and-plotting-an-ansys-archive-file">
<h2>Loading and Plotting an ANSYS Archive File<a class="headerlink" href="#loading-and-plotting-an-ansys-archive-file" title="Permalink to this headline">¶</a></h2>
<p id="examples-ref">ANSYS archive files containing solid elements (both legacy and modern) can be loaded using Archive and then converted to a vtk object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyansys</span>
<span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>

<span class="c1"># Sample *.cdb</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">hexarchivefile</span>

<span class="c1"># Read ansys archive file</span>
<span class="n">archive</span> <span class="o">=</span> <span class="n">pyansys</span><span class="o">.</span><span class="n">Archive</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="c1"># Print raw data from cdb</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">raw</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">archive</span><span class="o">.</span><span class="n">raw</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>

<span class="c1"># Create a vtk unstructured grid from the raw data and plot it</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">archive</span><span class="o">.</span><span class="n">parse_vtk</span><span class="p">(</span><span class="n">force_linear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">show_edges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># save this as a vtk xml file</span>
<span class="n">grid</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;hex.vtu&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/hexbeam.png" src="_images/hexbeam.png" />
<p>You can then load this vtk file using <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> or another program that uses VTK.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load this from vtk</span>
<span class="kn">import</span> <span class="nn">pyvista</span> <span class="kn">as</span> <span class="nn">pv</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">UnstructuredGrid</span><span class="p">(</span><span class="s1">&#39;hex.vtk&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-and-plotting-results-from-an-ansys-result-file">
<h2>Loading and Plotting Results from an ANSYS Result File<a class="headerlink" href="#loading-and-plotting-results-from-an-ansys-result-file" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-the-result-file">
<h3>Loading the Result File<a class="headerlink" href="#loading-the-result-file" title="Permalink to this headline">¶</a></h3>
<p>This example reads in binary results from a modal analysis of a beam from ANSYS.  This section of code does not rely on <code class="docutils literal notranslate"><span class="pre">VTK</span></code> and can be used with only numpy installed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the reader from pyansys</span>
<span class="kn">import</span> <span class="nn">pyansys</span>
<span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>

<span class="c1"># Sample result file</span>
<span class="n">rstfile</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">rstfile</span>

<span class="c1"># Create result object by loading the result file</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pyansys</span><span class="o">.</span><span class="n">read_binary</span><span class="p">(</span><span class="n">rstfile</span><span class="p">)</span>

<span class="c1"># Beam natural frequencies</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">time_values</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>
<span class="go">[ 7366.49503969  7366.49503969 11504.89523664 17285.70459456</span>
<span class="go">  17285.70459457 20137.19299035]</span>

<span class="go"># Get the 1st bending mode shape.  Results are ordered based on the sorted</span>
<span class="go"># node numbering.  Note that results are zero indexed</span>
<span class="go">nnum, disp = result.nodal_solution(0)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">disp</span><span class="p">)</span>
<span class="go">[[ 2.89623914e+01 -2.82480489e+01 -3.09226692e-01]</span>
<span class="go"> [ 2.89489249e+01 -2.82342416e+01  2.47536161e+01]</span>
<span class="go"> [ 2.89177130e+01 -2.82745126e+01  6.05151053e+00]</span>
<span class="go"> [ 2.88715048e+01 -2.82764960e+01  1.22913304e+01]</span>
<span class="go"> [ 2.89221536e+01 -2.82479511e+01  1.84965333e+01]</span>
<span class="go"> [ 2.89623914e+01 -2.82480489e+01  3.09226692e-01]</span>
<span class="go"> ...</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-nodal-results">
<h3>Plotting Nodal Results<a class="headerlink" href="#plotting-nodal-results" title="Permalink to this headline">¶</a></h3>
<p>As the geometry of the model is contained within the result file, you can plot the result without having to load any additional geometry.  Below, displacement for the first mode of the modal analysis beam is plotted using <code class="docutils literal notranslate"><span class="pre">VTK</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the displacement of Mode 0 in the x direction</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Displacement&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/hexbeam_disp.png" src="_images/hexbeam_disp.png" />
<p>Results can be plotted non-interactively and screenshots saved by setting up the camera and saving the result.  This can help with the visualization and post-processing of a batch result.</p>
<p>First, get the camera position from an interactive plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cpos</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">cpos</span><span class="p">)</span>
<span class="go">[(5.2722879880979345, 4.308737919176047, 10.467694436036483),</span>
<span class="go"> (0.5, 0.5, 2.5),</span>
<span class="go"> (-0.2565529433509593, 0.9227952809887077, -0.28745339908049733)]</span>
</pre></div>
</div>
<p>Then generate the plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Displacement&#39;</span><span class="p">,</span> <span class="n">cpos</span><span class="o">=</span><span class="n">cpos</span><span class="p">,</span>
                         <span class="n">screenshot</span><span class="o">=</span><span class="s1">&#39;hexbeam_disp.png&#39;</span><span class="p">,</span>
                         <span class="n">window_size</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Stress can be plotted as well using the below code.  The nodal stress is computed in the same manner that ANSYS uses by to determine the stress at each node by averaging the stress evaluated at that node for all attached elements.  For now, only component stresses can be displayed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display node averaged stress in x direction for result 6</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_stress</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/beam_stress.png" src="_images/beam_stress.png" />
<p>Nodal stress can also be generated non-interactively with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_stress</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">,</span> <span class="n">cpos</span><span class="o">=</span><span class="n">cpos</span><span class="p">,</span> <span class="n">screenshot</span><span class="o">=</span><span class="n">beam_stress</span><span class="o">.</span><span class="n">png</span><span class="p">,</span>
                         <span class="n">window_size</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="animating-a-modal-solution">
<h3>Animating a Modal Solution<a class="headerlink" href="#animating-a-modal-solution" title="Permalink to this headline">¶</a></h3>
<p>Mode shapes from a modal analsyis can be animated using <code class="docutils literal notranslate"><span class="pre">animate_nodal_solution</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">animate_nodal_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>If you wish to save the animation to a file, specify the movie_filename and animate it with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">animate_nodal_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">movie_filename</span><span class="o">=</span><span class="s1">&#39;/tmp/movie.mp4&#39;</span><span class="p">,</span> <span class="n">cpos</span><span class="o">=</span><span class="n">cpos</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/beam_mode_shape.gif" src="_images/beam_mode_shape.gif" />
</div>
</div>
<div class="section" id="built-in-examples">
<h2>Built-In Examples<a class="headerlink" href="#built-in-examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples can be run naively from pyansys by importing the examples sub-package.</p>
<div class="section" id="plot-cell-quality">
<h3>Plot Cell Quality<a class="headerlink" href="#plot-cell-quality" title="Permalink to this headline">¶</a></h3>
<p>This built-in example displays the minimum scaled jacobian of each element of a tetrahedral beam:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>
<span class="n">examples</span><span class="o">.</span><span class="n">show_cell_qual</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/cellqual.png" src="_images/cellqual.png" />
<p>This is the source code for the example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyansys</span>

<span class="c1"># load archive file and parse for subsequent FEM queries</span>
<span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>
<span class="c1"># archive = pyansys.Archive(examples.hexarchivefile)</span>
<span class="n">archive</span> <span class="o">=</span> <span class="n">pyansys</span><span class="o">.</span><span class="n">Archive</span><span class="p">(</span><span class="n">examples</span><span class="o">.</span><span class="n">tetarchivefile</span><span class="p">)</span>

<span class="c1"># create vtk object</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">archive</span><span class="o">.</span><span class="n">parse_vtk</span><span class="p">(</span><span class="n">force_linear</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># get cell quality</span>
<span class="n">qual</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">quality</span>

<span class="c1"># plot cell quality</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalars</span><span class="o">=</span><span class="n">qual</span><span class="p">,</span> <span class="n">stitle</span><span class="o">=</span><span class="s1">&#39;Cell Minimum Scaled</span><span class="se">\n</span><span class="s1">Jacobian&#39;</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-nodal-stress">
<h3>Plot Nodal Stress<a class="headerlink" href="#plot-nodal-stress" title="Permalink to this headline">¶</a></h3>
<p>This built in example plots the x component stress from a hexahedral beam.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>
<span class="n">examples</span><span class="o">.</span><span class="n">show_stress</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/beam_stress.png" src="_images/beam_stress.png" />
<p>This is the source code for the example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyansys</span>
<span class="kn">from</span> <span class="nn">pyansys</span> <span class="kn">import</span> <span class="n">examples</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">rstfile</span>

<span class="c1"># Create rsult object</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pyansys</span><span class="o">.</span><span class="n">read_binary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="c1"># Plot node averaged stress in x direction for result 6</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot_nodal_stress</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="loading_km.html" class="btn btn-neutral float-right" title="Working with a ANSYS Full File (full)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="loading_results.html" class="btn btn-neutral float-left" title="Working with a ANSYS Result File (rst)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Alex Kaszynski

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>